import unittest
from DN5 import *
from numpy import array, ndarray, nan, allclose
from pandas import DataFrame

test_case = unittest.TestCase()
results=preberi_podatke("public/data/februar.csv")
if type(results) is DataFrame:
    results = results.values
elif type(results) is ndarray:
    results=np.array(results.tolist())
    
expected = array([[  88.,  127.,  121.,    5.,   97.,   92.,   95.,  195.,   57.,  161.,   44.,   26.,   58.,   25.],
       [  59.,   72.,   27.,    6.,   29.,   21.,   33.,  100.,   48.,   96.,   30.,   68.,   15.,   31.],
       [  16.,   21.,   16.,    7.,   30.,   13.,   19.,   20.,   36.,   10.,   35.,   31.,    8.,   18.],
       [  19.,   28.,   21.,    4.,   28.,   24.,   21.,   26.,   20.,   22.,   30.,   21.,   12.,   18.],
       [  21.,   17.,   16.,    7.,   27.,   13.,   20.,   27.,   13.,   32.,   18.,   10.,    8.,   13.],
       [  16.,   13.,   13.,    4.,    9.,    9.,    9.,   14.,   12.,    9.,   26.,    5.,    3.,    5.],
       [  20.,   40.,   42.,   17.,   33.,   29.,   31.,   30.,   46.,   33.,   28.,   10.,   23.,    8.],
       [  34.,   47.,   41.,   24.,   43.,   34.,   38.,   36.,   39.,   43.,   29.,   21.,   37.,   15.],
       [  37.,   59.,   54.,   19.,   38.,   36.,   41.,   36.,   44.,   66.,   nan,   16.,   46.,   14.],
       [  53.,   61.,   62.,   29.,   53.,   47.,   48.,   59.,   48.,   58.,   34.,   21.,   59.,   20.],
       [  53.,   66.,   68.,   30.,   60.,   52.,   55.,   60.,   63.,   51.,   40.,   30.,   53.,   29.],
       [  47.,   76.,   88.,   26.,   77.,   74.,   75.,   55.,   67.,   53.,   42.,   25.,   73.,   31.],
       [  51.,   66.,   70.,   44.,   73.,   61.,   65.,   57.,   60.,   55.,   37.,   31.,   71.,   26.],
       [  45.,   72.,   72.,   27.,   72.,   48.,   63.,   65.,   53.,   81.,   35.,   29.,   47.,   34.],
       [  61.,   64.,   66.,    9.,   80.,   51.,   68.,   46.,   41.,   76.,   24.,   30.,   29.,   38.],
       [  60.,   65.,   76.,   20.,   85.,   59.,   72.,   54.,   37.,   90.,   24.,   30.,   36.,   59.],
       [  59.,   97.,   68.,   24.,   68.,   48.,   56.,   53.,   43.,   77.,   29.,   65.,   37.,   61.],
       [  27.,   34.,   34.,    8.,   43.,   28.,   35.,   33.,   32.,   39.,   22.,   33.,   22.,   21.],
       [  22.,   26.,   30.,    7.,   48.,   22.,   34.,   32.,   25.,   41.,   21.,   21.,   22.,   17.],
       [  40.,   44.,   57.,    9.,   64.,   42.,   57.,   39.,   37.,   61.,   30.,   42.,   29.,   36.],
       [  35.,   69.,   52.,   15.,   63.,   39.,   43.,   36.,   41.,   66.,   29.,   55.,   47.,   44.],
       [  35.,   56.,   44.,   13.,   52.,   35.,   36.,   39.,   34.,   55.,   27.,   81.,   35.,   84.],
       [  20.,   23.,   17.,   13.,   36.,   19.,   18.,   nan,   26.,   18.,   24.,   68.,   16.,   88.],
       [  14.,   26.,   15.,    5.,   20.,   13.,   14.,   nan,   14.,   14.,   20.,   38.,    8.,   18.],
       [  nan,   28.,   27.,    8.,   29.,   17.,   26.,   nan,   16.,   23.,   16.,    9.,   14.,    9.],
       [  25.,   27.,   39.,    8.,   35.,   22.,   40.,   nan,   17.,   41.,   19.,   15.,   18.,   11.],
       [  22.,   31.,   37.,   nan,   33.,   20.,   27.,   nan,   19.,   36.,   24.,   24.,   18.,   17.],
       [  19.,   23.,   19.,   nan,   25.,   17.,   16.,   nan,   25.,   16.,   16.,   27.,   15.,   20.]])
    
test_case.assertTrue(allclose(results, expected, equal_nan=True))